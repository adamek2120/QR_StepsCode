##### Libraries #####
library(tidyr)
library(haven)
library(dplyr)

##### Pulling in the data ####
setwd("C:/Users/jadamek2/Desktop/LAB_NUC/QR_data/QR_Cleaning_Processing_Files")
data <- read.csv("QR_CorrectDate.csv")
data <- data[c(1,2,3,10)]

##### Formatting and Preparing the data ####

# This uses the separate function to separate the date by month, day, and year
new = separate(data, col = CorrectDate, into = c("Month","Day", "Year"), sep = "/")

# This tallys their attendance (via class attendence) per month
new$feb <- ifelse(new$Month == 2, 1, 0)
new$mar <- ifelse(new$Month == 3, 1, 0)
new$apr <- ifelse(new$Month == 4, 1, 0)
new$may <- ifelse(new$Month == 5, 1, 0)
new$june <- ifelse(new$Month == 6, 1, 0)
new$july <- ifelse(new$Month == 7, 1, 0)
new$aug <- ifelse(new$Month == 8, 1, 0)
new$sep <- ifelse(new$Month == 9, 1, 0)
new$oct <- ifelse(new$Month == 10, 1, 0)
new$nov <- ifelse(new$Month == 11, 1, 0)
new$dec <- ifelse(new$Month == 12, 1, 0)
new$jan <- ifelse(new$Month == 1, 1, 0)

# ID's filtered by Waves
wave1 <- c(100,	101,	102,	103,	104,	105,	106,	107,	108,	109,	110,	111,	112,	113,	114,	115,	116,	117,	118,	120,	121,	122,	123,
           124,	125,	126,	127,	128,	129,	131,	132,	134,	135,	136,	137,	139,	141,	142,	143,	146,	147,	150,	151,	152,	153,	155,
           157,	158,	161,	162)
wave2 <- c(133, 138,  144,  149,  154,  156,  159,  160,  167,  168,  169,  170,  171,  172,  173,  174,  175,  176,  177,  178,  179,  181,  182,
           183, 184,  185,  186,  187,  188,  189,  190,  191,  192,  193,  194,  195,  196,  197,  198,  199,  200,  201,  202,  204,  205,  206)
wave3 <- c(207, 208,  209,  210,  211,  212,  213,  215,  216,  217,  218,  219,  220,  221,  222,  223,  224,  225,  226,  227,  229,  230,  231,
           232, 233,  234,  237,  238,  239,  240,  241,  242,  243,  244,  245,  247,  248,  249,  250,  251,  252,  253,  254,  255,  256,  257, 
           258)
wave4 <- c(214,	259,	260,	261,	262,	263,	264,	265,	266,	267,	268,	269,	271,	273,	274,	275,	277,	278,	279,	280,	281,	282,	283,
           284,	285,	287,	288,	289,	291)
wave5 <- c(292,	293,	294,	295,	296,	297,	298,	299,	300,	301,	302,	303,	304,	305,	306,	307,	308,	309,	310,	311,	312,	313,	314)
wave6 <- c(316,	317,	318,	319,	321,	322,	323,	324,	325,	326,	327,	328,	329,	330,	331,	332,	333,	334,	335,	336,	338,	339,	341,
           342,	343,  344,	345,	347,	348,	349,	350,	351,	353,	354,	355,	356,	357,	358)

# Separating ID's into their appropriate waves and saves them as raw files by waves
wave1_qr <- new[new$ID %in% wave1,]
wave2_qr <- new[new$ID %in% wave2,]
wave3_qr <- new[new$ID %in% wave3,]
wave4_qr <- new[new$ID %in% wave4,]
wave5_qr <- new[new$ID %in% wave5,]
wave6_qr <- new[new$ID %in% wave6,]

write.csv(wave1_qr, "wave1_qr.csv")
write.csv(wave2_qr, "wave2_qr.csv")
write.csv(wave3_qr, "wave3_qr.csv")
write.csv(wave4_qr, "wave4_qr.csv")
write.csv(wave5_qr, "wave5_qr.csv")
write.csv(wave6_qr, "wave6_qr.csv")

##### Creating separate files for each ID #####

#ID100 <- subset(data, ID == 100)
ID101 <- subset(new, ID == 101)
ID102 <- subset(new, ID == 102)
ID103 <- subset(new, ID == 103)
ID104 <- subset(new, ID == 104)
ID105 <- subset(new, ID == 105)
ID106 <- subset(new, ID == 106)
ID107 <- subset(new, ID == 107)
ID108 <- subset(new, ID == 108)
ID109 <- subset(new, ID == 109)
ID110 <- subset(new, ID == 110)
ID111 <- subset(new, ID == 111)
ID112 <- subset(new, ID == 112)
ID113 <- subset(new, ID == 113)
ID114 <- subset(new, ID == 114)
ID115 <- subset(new, ID == 115)
ID116 <- subset(new, ID == 116)
ID117 <- subset(new, ID == 117)
ID118 <- subset(new, ID == 118)

ID120 <- subset(new, ID == 120)
ID121 <- subset(new, ID == 121)
ID122 <- subset(new, ID == 122)
ID123 <- subset(new, ID == 123)
ID124 <- subset(new, ID == 124)
ID125 <- subset(new, ID == 125)
ID126 <- subset(new, ID == 126)
ID127 <- subset(new, ID == 127)
ID128 <- subset(new, ID == 128)
ID129 <- subset(new, ID == 129)

ID131 <- subset(new, ID == 131) 
ID132 <- subset(new, ID == 132)
ID133 <- subset(new, ID == 133)
ID134 <- subset(new, ID == 134)
ID135 <- subset(new, ID == 135)
ID136 <- subset(new, ID == 136)
ID137 <- subset(new, ID == 137)
#ID138 <- subset(data, ID == 138)
ID139 <- subset(new, ID == 139)

ID141 <- subset(new, ID == 141)
ID142 <- subset(new, ID == 142)
ID143 <- subset(new, ID == 143)
ID144 <- subset(new, ID == 144)

ID146 <- subset(new, ID == 146)
ID147 <- subset(new, ID == 147)

ID149 <- subset(new, ID == 149)
#ID150 <- subset(data, ID == 150)
ID151 <- subset(new, ID == 151)
ID152 <- subset(new, ID == 152)
ID153 <- subset(new, ID == 153)
ID154 <- subset(new, ID == 154)
ID155 <- subset(new, ID == 155)
ID156 <- subset(new, ID == 156)
ID157 <- subset(new, ID == 157)
ID158 <- subset(new, ID == 158)
ID159 <- subset(new, ID == 159)
#ID160 <- subset(data, ID == 160)
ID161 <- subset(new, ID == 161)
ID162 <- subset(new, ID == 162)


ID167 <- subset(new, ID == 167)
#ID168 <- subset(new, ID == 168)
ID169 <- subset(new, ID == 169)
ID170 <- subset(new, ID == 170)
#ID171 <- subset(new, ID == 171)
ID172 <- subset(new, ID == 172)
ID173 <- subset(new, ID == 173)
ID174 <- subset(new, ID == 174)
ID175 <- subset(new, ID == 175)
ID176 <- subset(new, ID == 176)
ID177 <- subset(new, ID == 177)
ID178 <- subset(new, ID == 178)
ID179 <- subset(new, ID == 179)

ID181 <- subset(new, ID == 181)
ID182 <- subset(new, ID == 182)
ID183 <- subset(new, ID == 183)
#ID184 <- subset(new, ID == 184)
ID185 <- subset(new, ID == 185)
ID186 <- subset(new, ID == 186)
ID187 <- subset(new, ID == 187)
ID188 <- subset(new, ID == 188)
ID189 <- subset(new, ID == 189)
ID190 <- subset(new, ID == 190)
ID191 <- subset(new, ID == 191)
ID192 <- subset(new, ID == 192)
ID193 <- subset(new, ID == 193)
ID194 <- subset(new, ID == 194)
ID195 <- subset(new, ID == 195)
ID196 <- subset(new, ID == 196)
ID197 <- subset(new, ID == 197)
ID198 <- subset(new, ID == 198)
ID199 <- subset(new, ID == 199)
ID200 <- subset(new, ID == 200)
ID201 <- subset(new, ID == 201)
ID202 <- subset(new, ID == 202)

ID204 <- subset(new, ID == 204)
ID205 <- subset(new, ID == 205)
ID206 <- subset(new, ID == 206)
ID207 <- subset(new, ID == 207)
#ID208 <- subset(new, ID == 208)
ID209 <- subset(new, ID == 209)
ID210 <- subset(new, ID == 210)
#ID211 <- subset(new, ID == 211)
ID212 <- subset(new, ID == 212)
#ID213 <- subset(new, ID == 213)
#ID214 <- subset(new, ID == 214)
ID215 <- subset(new, ID == 215)
ID216 <- subset(new, ID == 216)
ID217 <- subset(new, ID == 217)
ID218 <- subset(new, ID == 218)
ID219 <- subset(new, ID == 219)
#ID220 <- subset(new, ID == 220)
ID221 <- subset(new, ID == 221)
#ID222 <- subset(new, ID == 222)
ID223 <- subset(new, ID == 223)
ID224 <- subset(new, ID == 224)
ID225 <- subset(new, ID == 225)
ID226 <- subset(new, ID == 226)
ID227 <- subset(new, ID == 227)

ID229 <- subset(new, ID == 229)
ID230 <- subset(new, ID == 230)
ID231 <- subset(new, ID == 231)
ID232 <- subset(new, ID == 232)
ID233 <- subset(new, ID == 233)
ID234 <- subset(new, ID == 234)

ID237 <- subset(new, ID == 237)
#ID238 <- subset(data, ID == 238)
ID239 <- subset(new, ID == 239)
ID240 <- subset(new, ID == 240)
ID241 <- subset(new, ID == 241)
ID242 <- subset(new, ID == 242)
ID243 <- subset(new, ID == 243)
ID244 <- subset(new, ID == 244)
ID245 <- subset(new, ID == 245)

ID247 <- subset(new, ID == 247)
ID248 <- subset(new, ID == 248)
#ID249 <- subset(data, ID == 249)
ID250 <- subset(new, ID == 250)
#ID251 <- subset(data, ID == 251)
ID252 <- subset(new, ID == 252)
ID253 <- subset(new, ID == 253)
ID254 <- subset(new, ID == 254)
ID255 <- subset(new, ID == 255)
#ID256 <- subset(new, ID == 256)
ID257 <- subset(new, ID == 257)
ID258 <- subset(new, ID == 258)
ID259 <- subset(new, ID == 259)
ID260 <- subset(new, ID == 260)
#ID261 <- subset(new, ID == 261)
ID262 <- subset(new, ID == 262)
ID263 <- subset(new, ID == 263)
#ID264 <- subset(new, ID == 264)
ID265 <- subset(new, ID == 265)
#ID266 <- subset(new, ID == 266)
#ID267 <- subset(new, ID == 267)
ID268 <- subset(new, ID == 268)
ID269 <- subset(new, ID == 269)

ID271 <- subset(new, ID == 271)

ID273 <- subset(new, ID == 273)
#ID274 <- subset(new, ID == 274)
ID275 <- subset(new, ID == 275)

ID277 <- subset(new, ID == 277)
ID278 <- subset(new, ID == 278)
ID279 <- subset(new, ID == 279)
ID280 <- subset(new, ID == 280)
#ID281 <- subset(new, ID == 281)
#ID282 <- subset(new, ID == 282)
ID283 <- subset(new, ID == 283)
ID284 <- subset(new, ID == 284)
ID285 <- subset(new, ID == 285)

ID287 <- subset(new, ID == 287)
ID288 <- subset(new, ID == 288)
ID289 <- subset(new, ID == 289)

ID291 <- subset(new, ID == 291)
#ID292 <- subset(new, ID == 292)
ID293 <- subset(new, ID == 293)
ID294 <- subset(new, ID == 294)
ID295 <- subset(new, ID == 295)
ID296 <- subset(new, ID == 296)
ID297 <- subset(new, ID == 297)
ID298 <- subset(new, ID == 298)
ID299 <- subset(new, ID == 299)
ID300 <- subset(new, ID == 300)
ID301 <- subset(new, ID == 301)
ID302 <- subset(new, ID == 302)
ID303 <- subset(new, ID == 303)
ID304 <- subset(new, ID == 304)
ID305 <- subset(new, ID == 305)
ID306 <- subset(new, ID == 306)
ID307 <- subset(new, ID == 307)
#ID308 <- subset(new, ID == 308)
#ID309 <- subset(new, ID == 309)
ID310 <- subset(new, ID == 310)
ID311 <- subset(new, ID == 311)
#ID312 <- subset(new, ID == 312)
#ID313 <- subset(new, ID == 313)
#ID314 <- subset(new, ID == 314)

ID316 <- subset(new, ID == 316)
ID317 <- subset(new, ID == 317)
#ID318 <- subset(new, ID == 318)
ID319 <- subset(new, ID == 319)

ID321 <- subset(new, ID == 321)
ID322 <- subset(new, ID == 322)
#ID323 <- subset(new, ID == 323)
ID324 <- subset(new, ID == 324)
ID325 <- subset(new, ID == 325)
ID326 <- subset(new, ID == 326)
ID327 <- subset(new, ID == 327)
ID328 <- subset(new, ID == 328) 
ID329 <- subset(new, ID == 329)
ID330 <- subset(new, ID == 330)
ID331 <- subset(new, ID == 331)
ID332 <- subset(new, ID == 332)
ID333 <- subset(new, ID == 333)
#ID334 <- subset(new, ID == 334)
#ID335 <- subset(new, ID == 335)
#ID336 <- subset(new, ID == 336)

ID338 <- subset(new, ID == 338)
#ID339 <- subset(new, ID == 339)

ID341 <- subset(new, ID == 341)
ID342 <- subset(new, ID == 342)
ID343 <- subset(new, ID == 343)
ID344 <- subset(new, ID == 344)
#ID345 <- subset(new, ID == 345)

#ID347 <- subset(new, ID == 347)
ID348 <- subset(new, ID == 348)
ID349 <- subset(new, ID == 349)
ID350 <- subset(new, ID == 350)
#ID351 <- subset(new, ID == 351)

ID353 <- subset(new, ID == 353)
ID354 <- subset(new, ID == 354)
ID355 <- subset(new, ID == 355)
ID356 <- subset(new, ID == 356)
ID357 <- subset(new, ID == 357)
#ID358 <- subset(new, ID == 358)

##### Saving individual ID's to csv file AND folder #####
write.csv(ID101, "ID101.csv")
write.csv(ID102, "ID102.csv")
write.csv(ID103, "ID103.csv")
write.csv(ID104, "ID104.csv")
write.csv(ID105, "ID105.csv")
write.csv(ID106, "ID106.csv")
write.csv(ID107, "ID107.csv")
write.csv(ID108, "ID108.csv")
write.csv(ID109, "ID109.csv")
write.csv(ID110, "ID110.csv")
write.csv(ID111, "ID111.csv")
write.csv(ID112, "ID112.csv")
write.csv(ID113, "ID113.csv")
write.csv(ID114, "ID114.csv")
write.csv(ID115, "ID115.csv")
write.csv(ID116, "ID116.csv")
write.csv(ID117, "ID117.csv")
write.csv(ID118, "ID118.csv")
write.csv(ID120, "ID120.csv")
write.csv(ID121, "ID121.csv")
write.csv(ID122, "ID122.csv")
write.csv(ID123, "ID123.csv")
write.csv(ID124, "ID124.csv")
write.csv(ID125, "ID125.csv")
write.csv(ID126, "ID126.csv")
write.csv(ID127, "ID127.csv")
write.csv(ID128, "ID128.csv")
write.csv(ID129, "ID129.csv")
write.csv(ID131, "ID131.csv")
write.csv(ID132, "ID132.csv")
write.csv(ID133, "ID133.csv")
write.csv(ID134, "ID134.csv")
write.csv(ID135, "ID135.csv")
write.csv(ID136, "ID136.csv")
write.csv(ID137, "ID137.csv")
write.csv(ID139, "ID139.csv")
write.csv(ID141, "ID141.csv")
write.csv(ID142, "ID142.csv")
write.csv(ID143, "ID143.csv")
write.csv(ID144, "ID144.csv")
write.csv(ID146, "ID146.csv")
write.csv(ID147, "ID147.csv")
write.csv(ID149, "ID149.csv")
write.csv(ID151, "ID151.csv")
write.csv(ID152, "ID152.csv")
write.csv(ID154, "ID153.csv")
write.csv(ID154, "ID154.csv")
write.csv(ID155, "ID155.csv")
write.csv(ID156, "ID156.csv")
write.csv(ID157, "ID157.csv")
write.csv(ID158, "ID158.csv")
write.csv(ID159, "ID159.csv")
write.csv(ID161, "ID161.csv")
write.csv(ID162, "ID162.csv")
write.csv(ID167, "ID167.csv")
write.csv(ID169, "ID169.csv")
write.csv(ID170, "ID170.csv")
write.csv(ID172, "ID172.csv")
write.csv(ID173, "ID173.csv")
write.csv(ID174, "ID174.csv")
write.csv(ID175, "ID175.csv")
write.csv(ID176, "ID176.csv")
write.csv(ID177, "ID177.csv")
write.csv(ID178, "ID178.csv")
write.csv(ID179, "ID179.csv")
write.csv(ID181, "ID181.csv")
write.csv(ID182, "ID182.csv")
write.csv(ID183, "ID183.csv")

write.csv(ID185, "ID185.csv")
write.csv(ID186, "ID186.csv")
write.csv(ID187, "ID187.csv")
write.csv(ID188, "ID188.csv")
write.csv(ID189, "ID189.csv")
write.csv(ID190, "ID190.csv")
write.csv(ID191, "ID191.csv")
write.csv(ID192, "ID192.csv")
write.csv(ID193, "ID193.csv")
write.csv(ID194, "ID194.csv")
write.csv(ID195, "ID195.csv")
write.csv(ID196, "ID196.csv")
write.csv(ID197, "ID197.csv")
write.csv(ID198, "ID198.csv")
write.csv(ID199, "ID199.csv")
write.csv(ID200, "ID200.csv")
write.csv(ID201, "ID201.csv")
write.csv(ID202, "ID202.csv")
write.csv(ID204, "ID204.csv")
write.csv(ID205, "ID205.csv")
write.csv(ID206, "ID206.csv")
write.csv(ID207, "ID207.csv")
write.csv(ID209, "ID209.csv")
write.csv(ID210, "ID210.csv")
write.csv(ID212, "ID212.csv")
write.csv(ID215, "ID215.csv")
write.csv(ID216, "ID216.csv")
write.csv(ID217, "ID217.csv")
write.csv(ID218, "ID218.csv")
write.csv(ID219, "ID219.csv")
write.csv(ID221, "ID221.csv")
write.csv(ID223, "ID223.csv")
write.csv(ID224, "ID224.csv")
write.csv(ID225, "ID225.csv")
write.csv(ID226, "ID226.csv")
write.csv(ID227, "ID227.csv")
write.csv(ID229, "ID229.csv")
write.csv(ID230, "ID230.csv")
write.csv(ID231, "ID231.csv")
write.csv(ID232, "ID232.csv")
write.csv(ID233, "ID233.csv")
write.csv(ID234, "ID234.csv")
write.csv(ID237, "ID237.csv")
write.csv(ID239, "ID239.csv")
write.csv(ID240, "ID240.csv")
write.csv(ID241, "ID241.csv")
write.csv(ID242, "ID242.csv")
write.csv(ID243, "ID243.csv")
write.csv(ID244, "ID244.csv")
write.csv(ID245, "ID245.csv")
write.csv(ID247, "ID247.csv")
write.csv(ID248, "ID248.csv")
write.csv(ID250, "ID250.csv")
write.csv(ID252, "ID252.csv")
write.csv(ID253, "ID253.csv")
write.csv(ID254, "ID254.csv")
write.csv(ID255, "ID255.csv")
write.csv(ID257, "ID257.csv")
write.csv(ID258, "ID258.csv")
write.csv(ID259, "ID259.csv")
write.csv(ID260, "ID260.csv")
write.csv(ID262, "ID262.csv")
write.csv(ID263, "ID263.csv")
write.csv(ID265, "ID265.csv")
write.csv(ID268, "ID268.csv")
write.csv(ID269, "ID269.csv")
write.csv(ID271, "ID271.csv")
write.csv(ID273, "ID273.csv")
write.csv(ID275, "ID275.csv")
write.csv(ID277, "ID277.csv")
write.csv(ID278, "ID278.csv")
write.csv(ID279, "ID279.csv")
write.csv(ID280, "ID280.csv")
write.csv(ID283, "ID283.csv")
write.csv(ID284, "ID284.csv")
write.csv(ID285, "ID285.csv")
write.csv(ID287, "ID287.csv")
write.csv(ID288, "ID288.csv")
write.csv(ID289, "ID289.csv")
write.csv(ID291, "ID291.csv")
write.csv(ID293, "ID293.csv")
write.csv(ID294, "ID294.csv")
write.csv(ID295, "ID295.csv")
write.csv(ID296, "ID296.csv")
write.csv(ID297, "ID297.csv")
write.csv(ID298, "ID298.csv")
write.csv(ID299, "ID299.csv")
write.csv(ID300, "ID300.csv")
write.csv(ID301, "ID301.csv")
write.csv(ID302, "ID302.csv")
write.csv(ID303, "ID303.csv")
write.csv(ID304, "ID304.csv")
write.csv(ID305, "ID305.csv")
write.csv(ID306, "ID306.csv")
write.csv(ID307, "ID307.csv")
write.csv(ID310, "ID310.csv")
write.csv(ID311, "ID311.csv")
write.csv(ID316, "ID316.csv")
write.csv(ID317, "ID317.csv")
write.csv(ID319, "ID319.csv")
write.csv(ID321, "ID321.csv")
write.csv(ID322, "ID322.csv")
write.csv(ID324, "ID324.csv")
write.csv(ID325, "ID325.csv")
write.csv(ID326, "ID326.csv")
write.csv(ID327, "ID327.csv")
write.csv(ID328, "ID328.csv")
write.csv(ID329, "ID329.csv")
write.csv(ID330, "ID330.csv")
write.csv(ID331, "ID331.csv")
write.csv(ID332, "ID332.csv")
write.csv(ID333, "ID333.csv")
write.csv(ID338, "ID338.csv")
write.csv(ID341, "ID341.csv")
write.csv(ID342, "ID342.csv")
write.csv(ID343, "ID343.csv")
write.csv(ID344, "ID344.csv")
write.csv(ID348, "ID348.csv")
write.csv(ID349, "ID349.csv")
write.csv(ID350, "ID350.csv")
write.csv(ID353, "ID353.csv")
write.csv(ID354, "ID354.csv")
write.csv(ID355, "ID355.csv")
write.csv(ID356, "ID356.csv")
write.csv(ID357, "ID357.csv")


##### End of Step 2: Notes to be done before opening QR_step3.R #####
# Next step: Opened each ID's csv file to check for accuracy and ensure data is within the 12-month window. A couple IDs (i.e., 101) continue
# going to the gym after the studies 12-months and future dates needed to be removed